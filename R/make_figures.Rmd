This script is to make figures showing the results.

```{r}
library(tidyverse)
library(ggplot2)
library(ggtree)

# Load collated results
boston_confa_results <- read.delim("nextflow/results/boston_confa/collated_results.txt", sep = " ")

# Load method-specific results
mugration_treeio <- treeio::read.nhx(paste0(data_dir, "/mugration/annotated_tree.nhx"))
node_annotations <- as.data.frame(as_tibble(mugration_treeio))
mugration_phylo <- ape::as.phylo(mugration_treeio)
```

Plot number of clusters by method
```{r}
boston_confa_clusters_by_method <- boston_confa_results %>%
    filter(region == "CONF_A") %>%
    group_by(method) %>%
    summarise(n_samples = n(), n_clusters = length(unique(introduction_node)))

ggplot(data = boston_confa_clusters_by_method) +
    geom_col(aes(x = method, y = n_clusters))
```

TODO: how to visualize imports on tree and clusters?

Bits and bobs, leftovers
```{r}
# ggtree(mugration_treeio) + 
#     geom_label(aes(label = division)) +
#     geom_tiplab()
# ggsave("~/Downloads/tree.png", width = 20, height = 20)   
```